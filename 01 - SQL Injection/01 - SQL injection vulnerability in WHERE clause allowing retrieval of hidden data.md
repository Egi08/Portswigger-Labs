
# SQL injection vulnerability in WHERE clause allowing retrieval of hidden data

This lab contains a SQL injection vulnerability in the product category filter. When the user selects a category, the application carries out a SQL query like the following:

### Cara Enumerasi dan Mengeksploitasi Kerentanan SQL Injection

1. **Enumerasi Kerentanannya**  
   Aplikasi ini rentan terhadap SQL injection pada filter kategori produk, di mana parameter kategori yang dimasukkan oleh pengguna langsung disisipkan dalam query SQL. Query yang dieksekusi adalah:

   ```sql
   SELECT * FROM products WHERE category = 'Gifts' AND released = 1
   ```

   Kerentanannya terletak pada bagaimana aplikasi menangani input pengguna tanpa validasi yang cukup, yang memungkinkan kita untuk menyuntikkan perintah SQL yang tidak diinginkan ke dalam query.

2. **Eksploitasi untuk Mengakses Data Tersembunyi**  
   Untuk mengeksploitasi kerentanannya, kita dapat memasukkan payload SQL injection pada parameter `category`. Salah satu payload pertama yang dapat digunakan adalah `Gifts'--`, yang akan mengubah query SQL yang dikirimkan ke server seperti berikut:

   ```sql
   SELECT * FROM products WHERE category = 'Gifts'--' AND released = 1
   ```

   Di sini, tanda `'--` berfungsi sebagai komentar dalam SQL, yang mengabaikan bagian `AND released = 1`, sehingga query hanya memfilter berdasarkan kategori `Gifts`, dan menampilkan semua produk terkait tanpa mempedulikan status `released`. Produk yang tersembunyi atau belum dirilis pun akan terlihat.

   **Payload yang digunakan:**
   ```
   /filter?category=Gifts'-- 
   ```

   **Hasil:**  
   Setelah payload disuntikkan, kita akan melihat lebih banyak produk yang seharusnya tersembunyi karena mereka tidak memenuhi kondisi `released = 1`. Pada gambar berikut, kita melihat 4 produk, bukan hanya 3 produk yang dirilis.

   ![Gambar 1](images/SQL%20injection%20vulnerability%20in%20WHERE%20clause%20allowing%20retrieval%20of%20hidden%20data/3.png)

3. **Eksploitasi Lebih Lanjut untuk Menampilkan Semua Kategori**  
   Untuk mengekspos semua data produk, kita bisa memperluas serangan dengan menambahkan kondisi `OR 1=1`, yang membuat seluruh query selalu benar. Dengan menambahkan `OR 1=1`, query akan mengabaikan batasan apapun dan menampilkan seluruh kategori produk tanpa mempedulikan status `released`.

   **Query yang diubah menjadi:**
   ```sql
   SELECT * FROM products WHERE category = 'Gifts' OR 1=1-- 
   ```

   **Payload yang digunakan:**
   ```
   /filter?category=Gifts'+OR+1=1--
   ```

   **Hasil:**  
   Dengan payload ini, kita berhasil menampilkan semua kategori produk, baik yang dirilis maupun yang tersembunyi. Pada gambar berikut, seluruh kategori produk dapat terlihat, membuktikan bahwa query sekarang menampilkan lebih banyak data dari yang seharusnya.

   ![Gambar 2](images/SQL%20injection%20vulnerability%20in%20WHERE%20clause%20allowing%20retrieval%20of%20hidden%20data/4.png)

4. **Kesimpulan**  
   Dengan langkah-langkah enumerasi dan eksploitasi ini, kita dapat mengekspos data tersembunyi dalam aplikasi yang rentan terhadap SQL injection. Teknik ini menunjukkan pentingnya mengamankan input pengguna dan menggunakan query yang aman untuk menghindari potensi eksploitasi semacam ini.
