
# SQL injection vulnerability in WHERE clause allowing retrieval of hidden data

This lab contains a SQL injection vulnerability in the product category filter. When the user selects a category, the application carries out a SQL query like the following:

### Langkah-langkah Menyelesaikan Lab SQL Injection

Lab ini mengandung kerentanannya pada bagian filter kategori produk, di mana pengguna dapat memanipulasi query SQL yang dijalankan oleh aplikasi dengan menggunakan teknik SQL injection. Berikut adalah langkah-langkah untuk menyelesaikan lab ini :

1. **Memahami Kerentanannya**  
   Aplikasi ini menggunakan query SQL untuk memfilter produk berdasarkan kategori yang dipilih oleh pengguna. Query yang dijalankan oleh aplikasi adalah:

   ```sql
   SELECT * FROM products WHERE category = 'Gifts' AND released = 1
   ```

   Pada query tersebut, kolom `category` disaring berdasarkan input dari pengguna, dan hanya produk yang memiliki status `released = 1` yang ditampilkan.

2. **Melakukan SQL Injection untuk Mengakses Data Tersembunyi**  
   Untuk mengeksploitasi kerentanannya, kita dapat menyuntikkan payload ke dalam parameter `category`. Berikut adalah langkah-langkah untuk memanfaatkan SQL injection:

   - **Memilih Kategori dengan SQL Injection:**  
     Pertama, kita dapat memasukkan payload `Gifts'--` untuk mengubah query yang dikirim ke server. Penggunaan tanda `'--` berfungsi untuk mengomentari sisa query setelahnya, sehingga query menjadi:

     ```sql
     SELECT * FROM products WHERE category = 'Gifts'--' AND released = 1
     ```

     Dengan payload ini, aplikasi hanya akan memfilter berdasarkan kategori `Gifts` tanpa mempedulikan kondisi `released = 1`, sehingga kita dapat melihat produk yang tersembunyi (misalnya, yang belum dirilis).

     **Query yang digunakan:**
     ```
     /filter?category=Gifts'-- 
     ```

     **Hasil:**  
     Pada gambar yang ditampilkan, kita dapat melihat 4 item, termasuk yang tersembunyi (belum dirilis), bukan hanya 3 item yang biasanya terlihat.

     ![Gambar 1](images/SQL%20injection%20vulnerability%20in%20WHERE%20clause%20allowing%20retrieval%20of%20hidden%20data/3.png)

3. **Menampilkan Semua Kategori Menggunakan SQL Injection**  
   Untuk menampilkan semua kategori produk, kita dapat memperluas SQL injection dengan menambahkan kondisi `OR 1=1`, yang akan selalu benar, sehingga query menampilkan semua kategori tanpa batasan status `released`. Query yang diubah menjadi:

   ```sql
   SELECT * FROM products WHERE category = 'Gifts' OR 1=1-- 
   ```

   Dengan payload ini, kita dapat mengakses semua kategori produk, termasuk yang tersembunyi, karena kondisi `OR 1=1` akan selalu mengevaluasi menjadi benar.

   **Query yang digunakan:**
   ```
   /filter?category=Gifts'+OR+1=1--
   ```

   **Hasil:**  
   Pada gambar berikut, kita dapat melihat bahwa sekarang semua kategori produk ditampilkan, baik yang tersembunyi maupun yang telah dirilis.

   ![Gambar 2](images/SQL%20injection%20vulnerability%20in%20WHERE%20clause%20allowing%20retrieval%20of%20hidden%20data/4.png)

4. **Kesimpulan**  
   Dengan menggunakan teknik SQL injection ini, kita berhasil menampilkan produk yang sebelumnya tersembunyi dengan mengubah logika query yang digunakan oleh aplikasi. Kerentanan seperti ini menunjukkan pentingnya validasi input yang tepat dan penggunaan teknik yang aman dalam menangani query SQL untuk mencegah eksploitasi seperti ini.

### Referensi:
- [SQL Injection Vulnerability - PortSwigger](https://portswigger.net/web-security/sql-injection)
![img](images/SQL%20injection%20vulnerability%20in%20WHERE%20clause%20allowing%20retrieval%20of%20hidden%20data/4.png)
